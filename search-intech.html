<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡πÄ‡∏•‡∏Ç‡πÅ‡∏õ‡∏•‡∏á IN-TECH | ‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£‡∏ú‡πà‡∏≤‡∏Å‡∏≠</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', 'Sukhumvit', sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: flex-start;
            padding: 20px;
        }
        
        .container {
            background: white;
            border-radius: 20px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.1);
            width: 100%;
            max-width: 900px;
            overflow: hidden;
            margin-top: 20px;
        }
        
        .header {
            background: linear-gradient(135deg, #1a73e8 0%, #0d47a1 100%);
            color: white;
            padding: 30px;
            text-align: center;
            position: relative;
        }
        
        .header h1 {
            font-size: 2rem;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
        }
        
        .header p {
            opacity: 0.9;
            font-size: 1rem;
            max-width: 600px;
            margin: 0 auto;
            line-height: 1.5;
        }
        
        .content {
            padding: 30px;
        }
        
        .config-section {
            background: #f0f9ff;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 25px;
            border: 1px solid #bae6fd;
        }
        
        .config-title {
            font-weight: bold;
            color: #1a73e8;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .config-inputs {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 15px;
        }
        
        .config-group {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }
        
        .config-label {
            font-weight: 600;
            color: #4a5568;
            font-size: 0.9rem;
        }
        
        .config-input {
            padding: 12px 15px;
            border: 2px solid #cbd5e0;
            border-radius: 8px;
            font-size: 1rem;
            transition: all 0.3s;
        }
        
        .config-input:focus {
            outline: none;
            border-color: #1a73e8;
            box-shadow: 0 0 0 3px rgba(26, 115, 232, 0.2);
        }
        
        .search-section {
            margin-bottom: 25px;
        }
        
        .search-box {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }
        
        #searchInput {
            flex: 1;
            padding: 18px 20px;
            border: 3px solid #1a73e8;
            border-radius: 12px;
            font-size: 1.1rem;
            transition: all 0.3s;
        }
        
        #searchInput:focus {
            outline: none;
            border-color: #0d62d9;
            box-shadow: 0 0 0 4px rgba(26, 115, 232, 0.2);
        }
        
        .buttons {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }
        
        .btn {
            flex: 1;
            min-width: 140px;
            padding: 15px;
            border: none;
            border-radius: 12px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            transition: all 0.3s;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #1a73e8 0%, #0d62d9 100%);
            color: white;
        }
        
        .btn-secondary {
            background: #f8f9fa;
            color: #5f6368;
            border: 2px solid #ddd;
        }
        
        .btn-success {
            background: linear-gradient(135deg, #28a745 0%, #1e7e34 100%);
            color: white;
        }
        
        .btn-warning {
            background: linear-gradient(135deg, #ffc107 0%, #e0a800 100%);
            color: #212529;
        }
        
        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.15);
        }
        
        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        
        .result-section {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 25px;
            min-height: 150px;
        }
        
        .loading {
            text-align: center;
            padding: 40px;
            display: none;
        }
        
        .spinner {
            width: 50px;
            height: 50px;
            border: 5px solid #f3f3f3;
            border-top: 5px solid #1a73e8;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .no-data {
            text-align: center;
            padding: 40px 20px;
            color: #5f6368;
        }
        
        .no-data i {
            font-size: 4rem;
            color: #cbd5e0;
            margin-bottom: 20px;
        }
        
        .result-item {
            background: white;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 15px;
            border-left: 5px solid #1a73e8;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
        }
        
        .result-row {
            display: flex;
            padding: 10px 0;
            border-bottom: 1px solid #e2e8f0;
        }
        
        .result-row:last-child {
            border-bottom: none;
        }
        
        .result-label {
            font-weight: 600;
            color: #4a5568;
            width: 180px;
            min-width: 180px;
        }
        
        .result-value {
            color: #2d3748;
            flex: 1;
            word-break: break-word;
        }
        
        .highlight {
            background: #ffeaa7;
            padding: 2px 6px;
            border-radius: 4px;
            font-weight: bold;
        }
        
        .message {
            padding: 15px;
            border-radius: 10px;
            border: 2px solid;
            margin-bottom: 20px;
            display: none;
        }
        
        .success-message {
            background: #e6fffa;
            color: #234e52;
            border-color: #81e6d9;
        }
        
        .error-message {
            background: #fde8e8;
            color: #c53030;
            border-color: #feb2b2;
        }
        
        .info-message {
            background: #ebf8ff;
            color: #2c5282;
            border-color: #90cdf4;
        }
        
        .debug-info {
            margin-top: 25px;
            padding: 15px;
            background: #edf2f7;
            border-radius: 10px;
            font-size: 0.9rem;
            color: #4a5568;
        }
        
        .history-section {
            margin-top: 25px;
            padding: 15px;
            background: #f0f9ff;
            border-radius: 10px;
            border: 1px solid #bae6fd;
        }
        
        .history-title {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .history-items {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }
        
        .history-tag {
            background: white;
            border: 1px solid #bae6fd;
            padding: 8px 16px;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .history-tag:hover {
            background: #1a73e8;
            color: white;
            border-color: #1a73e8;
        }
        
        @media (max-width: 768px) {
            .container {
                margin-top: 10px;
                border-radius: 15px;
            }
            
            .header {
                padding: 20px;
            }
            
            .header h1 {
                font-size: 1.5rem;
                flex-direction: column;
                gap: 10px;
            }
            
            .content {
                padding: 20px;
            }
            
            .config-inputs {
                grid-template-columns: 1fr;
            }
            
            .buttons {
                flex-direction: column;
            }
            
            .btn {
                min-width: 100%;
            }
            
            .result-row {
                flex-direction: column;
            }
            
            .result-label {
                width: 100%;
                margin-bottom: 5px;
            }
            
            .history-items {
                justify-content: center;
            }
        }
        
        /* ‡πÄ‡∏°‡∏ô‡∏π‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• */
        .sample-menu {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 20px;
            border: 2px dashed #cbd5e0;
        }
        
        .sample-title {
            font-weight: bold;
            color: #4a5568;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .sample-buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }
        
        .sample-btn {
            background: white;
            border: 1px solid #1a73e8;
            color: #1a73e8;
            padding: 8px 16px;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .sample-btn:hover {
            background: #1a73e8;
            color: white;
        }
        
        .sheet-info {
            background: #fefce8;
            border: 1px solid #fef08a;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 20px;
            font-size: 0.9rem;
            color: #854d0e;
        }
    </style>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <div class="container">
        <div class="header">
            <h1><i class="fas fa-search"></i> ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡πÄ‡∏•‡∏Ç‡πÅ‡∏õ‡∏•‡∏á IN-TECH</h1>
            <p>‡∏£‡∏∞‡∏ö‡∏ö‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡πÄ‡∏•‡∏Ç‡πÅ‡∏õ‡∏•‡∏á‡∏à‡∏≤‡∏Å Google Sheet ‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£‡∏ú‡πà‡∏≤‡∏Å‡∏≠</p>
        </div>
        
        <div class="content">
            <!-- ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏™‡∏î‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ -->
            <div class="message success-message" id="successMessage"></div>
            <div class="message error-message" id="errorMessage"></div>
            <div class="message info-message" id="infoMessage"></div>
            
            <!-- ‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Google Sheets -->
            <div class="config-section">
                <div class="config-title">
                    <i class="fas fa-cog"></i> ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Google Sheets
                </div>
                <div class="config-inputs">
                    <div class="config-group">
                        <label class="config-label">Google Sheet ID</label>
                        <input type="text" 
                               id="sheetId" 
                               class="config-input"
                               placeholder="‡πÄ‡∏ä‡πà‡∏ô: 1XqYtG5jKpLmNoPqRsTuVwXyZ"
                               value="">
                    </div>
                    <div class="config-group">
                        <label class="config-label">‡∏ä‡∏∑‡πà‡∏≠‡∏ä‡∏µ‡∏ï (Sheet Name)</label>
                        <input type="text" 
                               id="sheetName" 
                               class="config-input"
                               placeholder="‡πÄ‡∏ä‡πà‡∏ô: ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞, Sheet1"
                               value="‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞">
                    </div>
                </div>
                <div class="buttons">
                    <button class="btn btn-success" id="saveConfigBtn">
                        <i class="fas fa-save"></i> ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤
                    </button>
                    <button class="btn btn-secondary" id="loadDataBtn">
                        <i class="fas fa-cloud-download-alt"></i> ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å Google Sheets
                    </button>
                </div>
                <div class="sheet-info">
                    <p><i class="fas fa-info-circle"></i> <strong>‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥:</strong> ‡∏ä‡∏∑‡πà‡∏≠‡∏ä‡∏µ‡∏ï‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏Ñ‡∏∑‡∏≠ "‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞" ‡∏´‡∏≤‡∏Å Google Sheets ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡πÉ‡∏ä‡πâ‡∏ä‡∏∑‡πà‡∏≠‡∏≠‡∏∑‡πà‡∏ô ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÉ‡∏´‡πâ‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ô</p>
                </div>
            </div>
            
            <!-- ‡πÄ‡∏°‡∏ô‡∏π‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• -->
            <div class="sample-menu">
                <div class="sample-title">
                    <i class="fas fa-lightbulb"></i> ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏î‡πâ‡∏ß‡∏¢‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á:
                </div>
                <div class="sample-buttons" id="sampleButtons">
                    <!-- ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏î‡πâ‡∏ß‡∏¢ JavaScript -->
                </div>
            </div>
            
            <!-- ‡∏ä‡πà‡∏≠‡∏á‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤ -->
            <div class="search-section">
                <div class="search-box">
                    <input type="text" 
                           id="searchInput" 
                           placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡πÄ‡∏•‡∏Ç‡πÅ‡∏õ‡∏•‡∏á‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤ ‡πÄ‡∏ä‡πà‡∏ô 10001145I1"
                           autocomplete="off"
                           autofocus
                           aria-label="‡∏ä‡πà‡∏≠‡∏á‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡πÄ‡∏•‡∏Ç‡πÅ‡∏õ‡∏•‡∏á">
                </div>
                
                <div class="buttons">
                    <button class="btn btn-primary" id="searchBtn" aria-label="‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•">
                        <i class="fas fa-search"></i> ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤
                    </button>
                    <button class="btn btn-secondary" id="clearBtn" aria-label="‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•">
                        <i class="fas fa-eraser"></i> ‡∏•‡πâ‡∏≤‡∏á
                    </button>
                    <button class="btn btn-warning" id="testBtn" aria-label="‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏£‡∏∞‡∏ö‡∏ö">
                        <i class="fas fa-vial"></i> ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏£‡∏∞‡∏ö‡∏ö
                    </button>
                </div>
            </div>
            
            <!-- ‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå -->
            <div class="result-section" id="resultSection">
                <div class="loading" id="loading">
                    <div class="spinner"></div>
                    <p id="loadingText">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...</p>
                </div>
                
                <div class="no-data" id="noData">
                    <i class="fas fa-search"></i>
                    <h3>‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤</h3>
                    <p>‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡πÄ‡∏•‡∏Ç‡πÅ‡∏õ‡∏•‡∏á‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤</p>
                </div>
                
                <div id="resultsContainer"></div>
            </div>
            
            <!-- ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤ -->
            <div class="history-section" id="historySection" style="display: none;">
                <div class="history-title">
                    <h4><i class="fas fa-history"></i> ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤</h4>
                    <button class="btn btn-secondary" id="clearHistoryBtn" style="padding: 5px 15px; font-size: 0.9rem;">
                        <i class="fas fa-trash"></i> ‡∏•‡πâ‡∏≤‡∏á‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥
                    </button>
                </div>
                <div class="history-items" id="historyItems">
                    <!-- ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏à‡∏∞‡πÅ‡∏™‡∏î‡∏á‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà -->
                </div>
            </div>
            
            <!-- ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏£‡∏∞‡∏ö‡∏ö -->
            <div class="debug-info">
                <p><strong>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏£‡∏∞‡∏ö‡∏ö:</strong> <span id="systemStatus">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏£‡∏∞‡∏ö‡∏ö...</span></p>
                <p><strong>‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö:</strong> <span id="dataCount">0 ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</span></p>
                <p><strong>‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤:</strong> <span id="historyCount">0 ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</span></p>
                <p><strong>Google Sheet:</strong> <span id="sheetStatus">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤</span></p>
                <p><small>‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏° "‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏£‡∏∞‡∏ö‡∏ö" ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö ‡∏´‡∏£‡∏∑‡∏≠ F12 ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏õ‡∏¥‡∏î Developer Console</small></p>
            </div>
        </div>
    </div>

    <script>
        // ============================================
        // 1. ‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£‡∏£‡∏∞‡∏ö‡∏ö
        // ============================================
        let sheetData = [];
        let systemReady = false;
        const SEARCH_HISTORY_KEY = 'in-tech-search-history';
        const CONFIG_KEY = 'in-tech-sheet-config';
        const MAX_HISTORY = 10;

        // ‡∏Ñ‡πà‡∏≤‡∏ï‡∏±‡πâ‡∏á‡∏ï‡πâ‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Google Sheets - ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏ä‡∏∑‡πà‡∏≠‡∏ä‡∏µ‡∏ï‡πÄ‡∏õ‡πá‡∏ô "‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞"
        let sheetConfig = {
            sheetId: '',
            sheetName: '‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞'  // ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏à‡∏≤‡∏Å 'Sheet1' ‡πÄ‡∏õ‡πá‡∏ô '‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞'
        };

        // ============================================
        // 2. ‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á DOM Elements
        // ============================================
        const elements = {
            // Config
            sheetId: document.getElementById('sheetId'),
            sheetName: document.getElementById('sheetName'),
            saveConfigBtn: document.getElementById('saveConfigBtn'),
            loadDataBtn: document.getElementById('loadDataBtn'),
            
            // Search
            searchInput: document.getElementById('searchInput'),
            searchBtn: document.getElementById('searchBtn'),
            clearBtn: document.getElementById('clearBtn'),
            testBtn: document.getElementById('testBtn'),
            
            // Messages
            successMessage: document.getElementById('successMessage'),
            errorMessage: document.getElementById('errorMessage'),
            infoMessage: document.getElementById('infoMessage'),
            
            // Results
            resultSection: document.getElementById('resultSection'),
            loading: document.getElementById('loading'),
            loadingText: document.getElementById('loadingText'),
            noData: document.getElementById('noData'),
            resultsContainer: document.getElementById('resultsContainer'),
            
            // History
            historySection: document.getElementById('historySection'),
            historyItems: document.getElementById('historyItems'),
            clearHistoryBtn: document.getElementById('clearHistoryBtn'),
            
            // Status
            systemStatus: document.getElementById('systemStatus'),
            dataCount: document.getElementById('dataCount'),
            historyCount: document.getElementById('historyCount'),
            sheetStatus: document.getElementById('sheetStatus'),
            
            // Sample buttons
            sampleButtons: document.getElementById('sampleButtons')
        };

        // ============================================
        // 3. ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏•‡∏∞‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞
        // ============================================
        function showMessage(type, text, duration = 5000) {
            const element = elements[`${type}Message`];
            const otherTypes = ['success', 'error', 'info'].filter(t => t !== type);
            
            element.textContent = text;
            element.style.display = 'block';
            
            otherTypes.forEach(otherType => {
                elements[`${otherType}Message`].style.display = 'none';
            });
            
            if (duration > 0) {
                setTimeout(() => {
                    element.style.display = 'none';
                }, duration);
            }
        }

        function showLoading(show, text = '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...') {
            elements.loading.style.display = show ? 'block' : 'none';
            elements.loadingText.textContent = text;
            if (show) {
                elements.noData.style.display = 'none';
            }
        }

        function updateSystemStatus() {
            elements.systemStatus.textContent = systemReady ? '‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô' : '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏£‡∏∞‡∏ö‡∏ö';
            elements.systemStatus.style.color = systemReady ? '#28a745' : '#e74c3c';
            elements.dataCount.textContent = `${sheetData.length} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£`;
            
            // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ Google Sheet
            if (sheetConfig.sheetId) {
                elements.sheetStatus.textContent = `‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÅ‡∏•‡πâ‡∏ß (‡∏ä‡∏µ‡∏ó: ${sheetConfig.sheetName})`;
                elements.sheetStatus.style.color = '#28a745';
            } else {
                elements.sheetStatus.textContent = '‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤';
                elements.sheetStatus.style.color = '#e74c3c';
            }
        }

        function setButtonLoading(button, isLoading) {
            const originalHTML = button.innerHTML;
            if (isLoading) {
                button.dataset.originalHTML = originalHTML;
                button.innerHTML = '<i class="fas fa-spinner fa-spin"></i> ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏•...';
                button.disabled = true;
            } else {
                if (button.dataset.originalHTML) {
                    button.innerHTML = button.dataset.originalHTML;
                }
                button.disabled = false;
            }
        }

        // ============================================
        // 4. ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÅ‡∏•‡∏∞ Google Sheets
        // ============================================
        function saveConfig() {
            const newConfig = {
                sheetId: elements.sheetId.value.trim(),
                sheetName: elements.sheetName.value.trim() || '‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞'  // ‡∏Ñ‡πà‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡πÄ‡∏õ‡πá‡∏ô '‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞'
            };
            
            if (!newConfig.sheetId) {
                showMessage('error', '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å Google Sheet ID');
                elements.sheetId.focus();
                return;
            }
            
            sheetConfig = newConfig;
            localStorage.setItem(CONFIG_KEY, JSON.stringify(sheetConfig));
            
            showMessage('success', '‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß');
            updateSystemStatus();
            
            console.log('üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤:', sheetConfig);
        }

        function loadConfig() {
            try {
                const savedConfig = localStorage.getItem(CONFIG_KEY);
                if (savedConfig) {
                    sheetConfig = JSON.parse(savedConfig);
                    elements.sheetId.value = sheetConfig.sheetId;
                    elements.sheetName.value = sheetConfig.sheetName;
                    console.log('üìÇ ‡πÇ‡∏´‡∏•‡∏î‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏à‡∏≤‡∏Å Local Storage:', sheetConfig);
                } else {
                    // ‡∏ñ‡πâ‡∏≤‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å ‡πÉ‡∏´‡πâ‡πÉ‡∏ä‡πâ‡∏Ñ‡πà‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô "‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞"
                    elements.sheetName.value = '‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞';
                }
            } catch (error) {
                console.error('‚ùå ‡πÇ‡∏´‡∏•‡∏î‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß:', error);
                // ‡πÉ‡∏ä‡πâ‡∏Ñ‡πà‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô "‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞" ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î
                elements.sheetName.value = '‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞';
            }
        }

        async function loadDataFromGoogleSheets() {
            if (!sheetConfig.sheetId) {
                showMessage('error', '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Google Sheet ID ‡∏Å‡πà‡∏≠‡∏ô');
                return;
            }
            
            setButtonLoading(elements.loadDataBtn, true);
            showLoading(true, '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å Google Sheets...');
            
            try {
                console.log('üì• ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å Google Sheets...');
                
                // ‡∏™‡∏£‡πâ‡∏≤‡∏á URL ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Google Sheets API (Public Sheet)
                // ‡πÉ‡∏ä‡πâ Google Visualization API Query
                const sheetId = sheetConfig.sheetId;
                const sheetName = encodeURIComponent(sheetConfig.sheetName);
                const url = `https://docs.google.com/spreadsheets/d/${sheetId}/gviz/tq?tqx=out:json&sheet=${sheetName}`;
                
                console.log('üîó URL ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•:', url);
                console.log('üìÑ ‡∏ä‡∏∑‡πà‡∏≠‡∏ä‡∏µ‡∏ï‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î:', sheetConfig.sheetName);
                
                const response = await fetch(url);
                
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                
                const text = await response.text();
                
                // ‡πÅ‡∏õ‡∏•‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å Google Visualization API format
                const jsonStart = text.indexOf('{');
                const jsonText = text.substring(jsonStart, text.length - 2); // ‡∏ï‡∏±‡∏î ; ‡∏≠‡∏≠‡∏Å
                const data = JSON.parse(jsonText);
                
                // ‡πÅ‡∏õ‡∏•‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏õ‡πá‡∏ô array ‡∏Ç‡∏≠‡∏á objects
                const rows = data.table.rows;
                const cols = data.table.cols;
                
                // ‡πÄ‡∏Å‡πá‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö debug
                const columnNames = cols.map(col => col.label);
                console.log('üè∑Ô∏è ‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÉ‡∏ô‡∏ä‡∏µ‡∏ó:', columnNames);
                
                sheetData = rows.map(row => {
                    const obj = {};
                    cols.forEach((col, index) => {
                        const cell = row.c[index];
                        obj[col.label] = cell ? (cell.v || '') : '';
                    });
                    return obj;
                });
                
                console.log('‚úÖ ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à:', sheetData);
                console.log('üìä ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏î‡πâ:', sheetData.length);
                
                if (sheetData.length > 0) {
                    console.log('üìã ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏£‡∏Å:', sheetData[0]);
                }
                
                updateSystemStatus();
                updateSampleButtons();
                
                showMessage('success', `‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å‡∏ä‡∏µ‡∏ó "${sheetConfig.sheetName}" ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à ${sheetData.length} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£`);
                
            } catch (error) {
                console.error('‚ùå ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß:', error);
                
                let errorMessage = '‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß: ';
                if (error.message.includes('Failed to fetch')) {
                    errorMessage += '‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Å‡∏±‡∏ö Google Sheets ‡πÑ‡∏î‡πâ';
                } else if (error.message.includes('404')) {
                    errorMessage += `‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏ä‡∏µ‡∏ó "${sheetConfig.sheetName}" ‡πÉ‡∏ô Google Sheet ‡∏ó‡∏µ‡πà‡∏£‡∏∞‡∏ö‡∏∏`;
                } else if (error.message.includes('SyntaxError')) {
                    errorMessage += '‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å Google Sheets ‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á';
                } else if (error.message.includes('‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•')) {
                    errorMessage += '‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡∏ä‡∏µ‡∏ó‡∏ó‡∏µ‡πà‡∏£‡∏∞‡∏ö‡∏∏';
                } else {
                    errorMessage += error.message;
                }
                
                showMessage('error', errorMessage);
                
                // ‡πÉ‡∏ä‡πâ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÅ‡∏ó‡∏ô
                loadSampleDataAsFallback();
                
            } finally {
                setButtonLoading(elements.loadDataBtn, false);
                showLoading(false);
            }
        }

        function loadSampleDataAsFallback() {
            console.log('üîÑ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÅ‡∏ó‡∏ô...');
            
            // ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ä‡∏µ‡∏ó "‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞"
            const sampleData = [
                {
                    '‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡πÅ‡∏õ‡∏•‡∏á': '10001145I1',
                    '‡∏ä‡∏∑‡πà‡∏≠‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£': '‡∏ú‡πà‡∏≤‡∏Å‡∏≠',
                    '‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡πÅ‡∏õ‡∏•‡∏á': '‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó ‡∏≠‡∏¥‡∏ô‡πÄ‡∏ó‡∏Ñ ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
                    '‡∏ó‡∏µ‡πà‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏õ‡∏•‡∏á': '‡∏≠.‡πÄ‡∏°‡∏∑‡∏≠‡∏á ‡∏à.‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡πÉ‡∏´‡∏°‡πà',
                    '‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà': '2.5 ‡πÑ‡∏£‡πà',
                    '‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÅ‡∏õ‡∏•‡∏á': '‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£',
                    '‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏': '‡πÅ‡∏õ‡∏•‡∏á IN-TECH ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç 001',
                    '‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó': '‡πÇ‡∏£‡∏á‡∏á‡∏≤‡∏ô',
                    '‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£': '01/01/2023',
                    '‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£': '31/12/2023'
                },
                {
                    '‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡πÅ‡∏õ‡∏•‡∏á': 'IN-TECH-002',
                    '‡∏ä‡∏∑‡πà‡∏≠‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£': '‡∏ú‡πà‡∏≤‡∏Å‡∏≠',
                    '‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡πÅ‡∏õ‡∏•‡∏á': '‡∏ô‡∏≤‡∏¢‡∏™‡∏°‡∏ä‡∏≤‡∏¢ ‡πÉ‡∏à‡∏î‡∏µ',
                    '‡∏ó‡∏µ‡πà‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏õ‡∏•‡∏á': '‡∏≠.‡πÄ‡∏°‡∏∑‡∏≠‡∏á ‡∏à.‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡πÉ‡∏´‡∏°‡πà',
                    '‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà': '1 ‡πÑ‡∏£‡πà',
                    '‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÅ‡∏õ‡∏•‡∏á': '‡∏£‡∏≠‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£',
                    '‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏': '‡πÅ‡∏õ‡∏•‡∏á‡∏õ‡∏•‡∏π‡∏Å‡∏ú‡∏±‡∏Å‡∏≠‡∏¥‡∏ô‡∏ó‡∏£‡∏µ‡∏¢‡πå',
                    '‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó': '‡πÄ‡∏Å‡∏©‡∏ï‡∏£',
                    '‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£': '15/03/2023',
                    '‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£': '14/03/2024'
                },
                {
                    '‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡πÅ‡∏õ‡∏•‡∏á': '2000223344',
                    '‡∏ä‡∏∑‡πà‡∏≠‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£': '‡∏ú‡πà‡∏≤‡∏Å‡∏≠',
                    '‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡πÅ‡∏õ‡∏•‡∏á': '‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏™‡∏∏‡∏ô‡∏¥‡∏î‡∏≤ ‡∏£‡∏±‡∏Å‡∏ò‡∏£‡∏£‡∏°',
                    '‡∏ó‡∏µ‡πà‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏õ‡∏•‡∏á': '‡∏≠.‡πÄ‡∏°‡∏∑‡∏≠‡∏á ‡∏à.‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡πÉ‡∏´‡∏°‡πà',
                    '‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà': '3 ‡πÑ‡∏£‡πà',
                    '‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÅ‡∏õ‡∏•‡∏á': '‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô',
                    '‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏': '‡πÅ‡∏õ‡∏•‡∏á‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏Å‡∏£‡∏∞‡∏à‡∏≤‡∏¢‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤',
                    '‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó': '‡∏Ñ‡∏•‡∏±‡∏á‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤',
                    '‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£': '10/02/2023',
                    '‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£': '09/02/2024'
                },
                {
                    '‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡πÅ‡∏õ‡∏•‡∏á': 'TECH-003',
                    '‡∏ä‡∏∑‡πà‡∏≠‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£': '‡∏ú‡πà‡∏≤‡∏Å‡∏≠',
                    '‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡πÅ‡∏õ‡∏•‡∏á': '‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó ‡πÄ‡∏ó‡∏Ñ‡πÇ‡∏ô‡πÇ‡∏•‡∏¢‡∏µ ‡πÑ‡∏ó‡∏¢ ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
                    '‡∏ó‡∏µ‡πà‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏õ‡∏•‡∏á': '‡∏≠.‡πÄ‡∏°‡∏∑‡∏≠‡∏á ‡∏à.‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡πÉ‡∏´‡∏°‡πà',
                    '‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà': '5 ‡πÑ‡∏£‡πà',
                    '‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÅ‡∏õ‡∏•‡∏á': '‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£',
                    '‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏': '‡πÅ‡∏õ‡∏•‡∏á‡πÇ‡∏£‡∏á‡∏á‡∏≤‡∏ô‡∏ú‡∏•‡∏¥‡∏ï',
                    '‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó': '‡πÇ‡∏£‡∏á‡∏á‡∏≤‡∏ô',
                    '‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£': '20/01/2023',
                    '‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£': '19/01/2024'
                },
                {
                    '‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡πÅ‡∏õ‡∏•‡∏á': 'PAKA-004',
                    '‡∏ä‡∏∑‡πà‡∏≠‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£': '‡∏ú‡πà‡∏≤‡∏Å‡∏≠',
                    '‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡πÅ‡∏õ‡∏•‡∏á': '‡∏´‡∏à‡∏Å.‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏Å‡∏≤‡∏£‡πÄ‡∏Å‡∏©‡∏ï‡∏£',
                    '‡∏ó‡∏µ‡πà‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏õ‡∏•‡∏á': '‡∏≠.‡∏™‡∏±‡∏ô‡∏ó‡∏£‡∏≤‡∏¢ ‡∏à.‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡πÉ‡∏´‡∏°‡πà',
                    '‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà': '10 ‡πÑ‡∏£‡πà',
                    '‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÅ‡∏õ‡∏•‡∏á': '‡∏ß‡∏≤‡∏á‡πÅ‡∏ú‡∏ô',
                    '‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏': '‡πÅ‡∏õ‡∏•‡∏á‡∏ó‡∏î‡∏•‡∏≠‡∏á‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡∏ú‡∏™‡∏°‡∏ú‡∏™‡∏≤‡∏ô',
                    '‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó': '‡∏ß‡∏¥‡∏à‡∏±‡∏¢',
                    '‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£': '01/04/2023',
                    '‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£': '31/03/2024'
                }
            ];
            
            sheetData = sampleData;
            updateSystemStatus();
            updateSampleButtons();
            
            showMessage('info', '‡πÉ‡∏ä‡πâ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÅ‡∏ó‡∏ô‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏≤‡∏Å‡πÇ‡∏´‡∏•‡∏î‡∏à‡∏≤‡∏Å Google Sheets ‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß');
        }

        // ============================================
        // 5. ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤
        // ============================================
        function saveSearchHistory(searchTerm) {
            let history = JSON.parse(localStorage.getItem(SEARCH_HISTORY_KEY)) || [];
            
            history = history.filter(item => item.toLowerCase() !== searchTerm.toLowerCase());
            history.unshift(searchTerm);
            history = history.slice(0, MAX_HISTORY);
            
            localStorage.setItem(SEARCH_HISTORY_KEY, JSON.stringify(history));
            updateHistoryDisplay();
        }

        function updateHistoryDisplay() {
            const history = JSON.parse(localStorage.getItem(SEARCH_HISTORY_KEY)) || [];
            
            elements.historyCount.textContent = `${history.length} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£`;
            
            if (history.length > 0) {
                elements.historySection.style.display = 'block';
                elements.historyItems.innerHTML = '';
                
                history.forEach(term => {
                    const tag = document.createElement('div');
                    tag.className = 'history-tag';
                    tag.innerHTML = `
                        <i class="fas fa-search"></i>
                        ${term}
                    `;
                    
                    tag.addEventListener('click', () => {
                        elements.searchInput.value = term;
                        performSearch();
                    });
                    
                    elements.historyItems.appendChild(tag);
                });
            } else {
                elements.historySection.style.display = 'none';
            }
        }

        function clearSearchHistory() {
            localStorage.removeItem(SEARCH_HISTORY_KEY);
            updateHistoryDisplay();
            showMessage('success', '‡∏•‡πâ‡∏≤‡∏á‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß');
        }

        // ============================================
        // 6. ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
        // ============================================
        function validateInput(searchTerm) {
            searchTerm = searchTerm.trim();
            
            if (!searchTerm) {
                throw new Error('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡πÄ‡∏•‡∏Ç‡πÅ‡∏õ‡∏•‡∏á‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤');
            }
            
            if (searchTerm.length < 2) {
                throw new Error('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 2 ‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£');
            }
            
            if (sheetData.length === 0) {
                throw new Error('‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡πà‡∏≠‡∏ô');
            }
            
            return searchTerm;
        }

        function performSearch() {
            try {
                const searchTerm = validateInput(elements.searchInput.value);
                
                console.log(`üîç ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤: "${searchTerm}"`);
                console.log(`üìä ‡πÉ‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î ${sheetData.length} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£`);
                
                showLoading(true, '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...');
                elements.resultsContainer.innerHTML = '';
                
                // ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤
                saveSearchHistory(searchTerm);
                
                // ‡∏´‡∏ô‡πà‡∏ß‡∏á‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏•‡πá‡∏Å‡∏ô‡πâ‡∏≠‡∏¢‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡πÄ‡∏´‡πá‡∏ô animation
                setTimeout(() => {
                    try {
                        const results = searchInData(searchTerm);
                        displayResults(results, searchTerm);
                        showLoading(false);
                        
                        if (results.length > 0) {
                            showMessage('success', `‡∏û‡∏ö ${results.length} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö "${searchTerm}"`);
                        } else {
                            showMessage('error', `‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö "${searchTerm}"`);
                        }
                        
                    } catch (error) {
                        console.error('‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤:', error);
                        showMessage('error', error.message);
                        showLoading(false);
                    }
                }, 800);
                
            } catch (error) {
                showMessage('error', error.message);
                elements.searchInput.focus();
            }
        }

        function searchInData(searchTerm) {
            console.log('üìä ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡πÉ‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...');
            
            const results = [];
            const searchLower = searchTerm.toLowerCase();
            
            sheetData.forEach((item, index) => {
                let found = false;
                let foundInColumn = '';
                
                // ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡πÉ‡∏ô‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå
                for (const column in item) {
                    const value = String(item[column] || '');
                    const valueLower = value.toLowerCase();
                    
                    // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏´‡∏•‡∏≤‡∏¢‡πÄ‡∏á‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏Ç
                    if (value === searchTerm || 
                        value.includes(searchTerm) || 
                        valueLower.includes(searchLower) ||
                        value.replace(/\s+/g, '').includes(searchTerm.replace(/\s+/g, ''))) {
                        found = true;
                        foundInColumn = column;
                        console.log(`‚úÖ ‡∏û‡∏ö‡∏ó‡∏µ‡πà‡πÅ‡∏ñ‡∏ß ${index + 1}, ‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå "${column}": "${value}"`);
                        break;
                    }
                }
                
                if (found) {
                    results.push({
                        ...item,
                        _matchInfo: `‡∏û‡∏ö‡πÉ‡∏ô‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå: ${foundInColumn}`,
                        _index: index + 2 // +2 ‡πÄ‡∏û‡∏£‡∏≤‡∏∞‡πÅ‡∏ñ‡∏ß‡∏ó‡∏µ‡πà 1 ‡∏Ñ‡∏∑‡∏≠‡∏´‡∏±‡∏ß‡∏ï‡∏≤‡∏£‡∏≤‡∏á ‡πÅ‡∏•‡∏∞ index ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ó‡∏µ‡πà 0
                    });
                }
            });
            
            console.log('üîö ‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤, ‡∏û‡∏ö‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î:', results.length, '‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£');
            return results;
        }

        // ============================================
        // 7. ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå
        // ============================================
        function displayResults(results, searchTerm) {
            elements.resultsContainer.innerHTML = '';
            
            if (results.length === 0) {
                elements.noData.innerHTML = `
                    <i class="fas fa-search-minus"></i>
                    <h3>‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö "${searchTerm}"</h3>
                    <p>‡∏•‡∏≠‡∏á‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡πÉ‡∏´‡∏°‡πà‡∏î‡πâ‡∏ß‡∏¢‡∏Ñ‡∏≥‡∏ó‡∏µ‡πà‡πÅ‡∏ï‡∏Å‡∏ï‡πà‡∏≤‡∏á</p>
                    <div style="margin-top: 15px; background: #fff; padding: 15px; border-radius: 8px;">
                        <p><strong>‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥:</strong></p>
                        <p>‚Ä¢ ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏™‡∏∞‡∏Å‡∏î‡πÄ‡∏•‡∏Ç‡πÅ‡∏õ‡∏•‡∏á</p>
                        <p>‚Ä¢ ‡∏•‡∏≠‡∏á‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏™‡πà‡∏ß‡∏ô‡∏Ç‡∏≠‡∏á‡πÄ‡∏•‡∏Ç (‡πÄ‡∏ä‡πà‡∏ô 100011, TECH, 002)</p>
                        <p>‚Ä¢ ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö‡∏°‡∏µ ${sheetData.length} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏à‡∏≤‡∏Å‡∏ä‡∏µ‡∏ó "${sheetConfig.sheetName}"</p>
                    </div>
                `;
                elements.noData.style.display = 'block';
                return;
            }
            
            elements.noData.style.display = 'none';
            
            // ‡πÅ‡∏™‡∏î‡∏á‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå
            const header = document.createElement('div');
            header.className = 'result-item';
            header.style.backgroundColor = '#E8F0FE';
            header.innerHTML = `
                <h3 style="color: #1a73e8; margin: 0;">
                    <i class="fas fa-check-circle"></i> 
                    ‡∏û‡∏ö ${results.length} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö "${searchTerm}"
                </h3>
                <p style="margin-top: 5px; color: #5f6368;">
                    ${results.length > 10 ? '‡πÅ‡∏™‡∏î‡∏á 10 ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÅ‡∏£‡∏Å (‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ñ‡∏≥‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡πÉ‡∏´‡πâ‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡πÄ‡∏à‡∏≤‡∏∞‡∏à‡∏á‡∏°‡∏≤‡∏Å‡∏Ç‡∏∂‡πâ‡∏ô)' : '‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏Ñ‡πâ‡∏ô‡∏û‡∏ö‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏à‡∏≤‡∏Å‡∏ä‡∏µ‡∏ó "' + sheetConfig.sheetName + '"'}
                </p>
            `;
            elements.resultsContainer.appendChild(header);
            
            // ‡πÅ‡∏™‡∏î‡∏á‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå (‡∏à‡∏≥‡∏Å‡∏±‡∏î‡∏ó‡∏µ‡πà 10 ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£)
            const displayResults = results.slice(0, 10);
            
            displayResults.forEach((item, index) => {
                const resultCard = document.createElement('div');
                resultCard.className = 'result-item';
                
                let html = `
                    <div style="margin-bottom: 15px; padding-bottom: 10px; border-bottom: 2px solid #1a73e8;">
                        <h4 style="color: #1a73e8; margin: 0;">
                            <i class="fas fa-map-marker-alt"></i>
                            ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏ó‡∏µ‡πà ${index + 1} (‡πÅ‡∏ñ‡∏ß‡∏ó‡∏µ‡πà ${item._index} ‡πÉ‡∏ô‡∏ä‡∏µ‡∏ó "${sheetConfig.sheetName}")
                        </h4>
                        ${item._matchInfo ? `<p style="color: #666; font-size: 0.9em; margin-top: 5px;">${item._matchInfo}</p>` : ''}
                    </div>
                `;
                
                // ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
                let rowCount = 0;
                for (const key in item) {
                    if (key.startsWith('_')) continue;
                    
                    let value = item[key] || '(‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•)';
                    rowCount++;
                    
                    // ‡πÄ‡∏ô‡πâ‡∏ô‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏Ñ‡πâ‡∏ô‡∏û‡∏ö
                    if (typeof value === 'string' && value.length > 0) {
                        const searchPattern = searchTerm.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
                        const regex = new RegExp(`(${searchPattern})`, 'gi');
                        value = value.replace(regex, '<span class="highlight">$1</span>');
                    }
                    
                    html += `
                        <div class="result-row">
                            <div class="result-label">${key}:</div>
                            <div class="result-value">${value}</div>
                        </div>
                    `;
                }
                
                // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏õ‡∏∏‡πà‡∏°‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
                html += `
                    <div style="margin-top: 15px; display: flex; justify-content: space-between; align-items: center;">
                        <small style="color: #666;">${rowCount} ‡∏ü‡∏¥‡∏•‡∏î‡πå‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</small>
                        <button class="btn btn-secondary copy-btn" data-index="${index}" 
                                style="padding: 8px 16px; font-size: 0.9rem;">
                            <i class="far fa-copy"></i> ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
                        </button>
                    </div>
                `;
                
                resultCard.innerHTML = html;
                elements.resultsContainer.appendChild(resultCard);
            });
            
            // ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ñ‡πâ‡∏≤‡∏°‡∏µ‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏°‡∏≤‡∏Å‡∏Å‡∏ß‡πà‡∏≤ 10 ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£
            if (results.length > 10) {
                const warning = document.createElement('div');
                warning.className = 'result-item';
                warning.style.backgroundColor = '#FFF3CD';
                warning.style.borderLeftColor = '#FFC107';
                warning.innerHTML = `
                    <p><i class="fas fa-info-circle"></i> ‡∏û‡∏ö‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î ${results.length} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ ‡πÅ‡∏ï‡πà‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏û‡∏µ‡∏¢‡∏á 10 ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÅ‡∏£‡∏Å</p>
                    <p>‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ñ‡∏≥‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡πÉ‡∏´‡πâ‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡πÄ‡∏à‡∏≤‡∏∞‡∏à‡∏á‡∏°‡∏≤‡∏Å‡∏Ç‡∏∂‡πâ‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏•‡∏î‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå</p>
                `;
                elements.resultsContainer.appendChild(warning);
            }
            
            // ‡πÄ‡∏û‡∏¥‡πà‡∏° event listener ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏õ‡∏∏‡πà‡∏°‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å
            document.querySelectorAll('.copy-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const index = parseInt(this.getAttribute('data-index'));
                    copyResultToClipboard(displayResults[index]);
                });
            });
        }

        // ============================================
        // 8. ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ï‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏õ‡∏∏‡πà‡∏°
        // ============================================
        function updateSampleButtons() {
            elements.sampleButtons.innerHTML = '';
            
            if (sheetData.length === 0) return;
            
            // ‡∏´‡∏≤‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå‡πÅ‡∏£‡∏Å (‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡πÅ‡∏õ‡∏•‡∏á)
            const sampleValues = new Set();
            const firstColumn = Object.keys(sheetData[0])[0];
            
            sheetData.slice(0, 5).forEach(item => {
                const value = item[firstColumn];
                if (value && value.trim()) {
                    sampleValues.add(value);
                }
            });
            
            // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ
            sampleValues.add('IN-TECH');
            sampleValues.add('TECH');
            sampleValues.add('‡∏ú‡πà‡∏≤‡∏Å‡∏≠');
            
            // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏õ‡∏∏‡πà‡∏°
            Array.from(sampleValues).slice(0, 6).forEach(term => {
                const btn = document.createElement('button');
                btn.className = 'sample-btn';
                btn.textContent = String(term).substring(0, 20) + (String(term).length > 20 ? '...' : '');
                btn.title = term;
                btn.addEventListener('click', () => {
                    elements.searchInput.value = term;
                    performSearch();
                });
                elements.sampleButtons.appendChild(btn);
            });
        }

        // ============================================
        // 9. ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏£‡∏∞‡∏ö‡∏ö
        // ============================================
        function testSystem() {
            console.group('üß™ ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏£‡∏∞‡∏ö‡∏ö‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤');
            
            console.log('üìã ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö:', sheetData);
            console.log('üî¢ ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•:', sheetData.length);
            
            if (sheetData.length > 0) {
                console.log('üè∑Ô∏è ‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î:', Object.keys(sheetData[0]));
                console.log('üìÑ ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• 3 ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÅ‡∏£‡∏Å:', sheetData.slice(0, 3));
            }
            
            console.log('‚öôÔ∏è ‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Google Sheets:', sheetConfig);
            
            // ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏à‡∏≤‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏£‡∏¥‡∏á
            if (sheetData.length > 0) {
                const firstValue = sheetData[0][Object.keys(sheetData[0])[0]];
                if (firstValue) {
                    console.log(`üîç ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤ "${firstValue}":`);
                    const results = searchInData(firstValue);
                    console.log(`   ‡∏ú‡∏•: ${results.length} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£`);
                    
                    if (results.length > 0) {
                        console.log('   ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡πÅ‡∏£‡∏Å:', results[0]);
                    }
                }
                
                // ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤ "IN-TECH"
                console.log(`üîç ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤ "IN-TECH":`);
                const techResults = searchInData("IN-TECH");
                console.log(`   ‡∏ú‡∏•: ${techResults.length} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£`);
            }
            
            console.groupEnd();
            
            showMessage('success', '‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à! ‡∏î‡∏π‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡πÉ‡∏ô Console (F12)');
        }

        // ============================================
        // 10. ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÄ‡∏™‡∏£‡∏¥‡∏°
        // ============================================
        function clearSearch() {
            elements.searchInput.value = '';
            elements.resultsContainer.innerHTML = '';
            elements.noData.innerHTML = `
                <i class="fas fa-search"></i>
                <h3>‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤</h3>
                <p>‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡πÄ‡∏•‡∏Ç‡πÅ‡∏õ‡∏•‡∏á‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤</p>
            `;
            elements.noData.style.display = 'block';
            
            // ‡∏ã‡πà‡∏≠‡∏ô‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
            ['success', 'error', 'info'].forEach(type => {
                elements[`${type}Message`].style.display = 'none';
            });
            
            elements.searchInput.focus();
            console.log('üßπ ‡∏•‡πâ‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡πÅ‡∏•‡πâ‡∏ß');
        }

        function copyResultToClipboard(data) {
            let text = `‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏õ‡∏•‡∏á‡∏ó‡∏µ‡πà‡∏Ñ‡πâ‡∏ô‡∏û‡∏ö‡∏à‡∏≤‡∏Å‡∏ä‡∏µ‡∏ó "${sheetConfig.sheetName}":\n\n`;
            
            for (const key in data) {
                if (!key.startsWith('_')) {
                    text += `${key}: ${data[key] || '(‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•)'}\n`;
                }
            }
            
            navigator.clipboard.writeText(text)
                .then(() => {
                    showMessage('success', '‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏õ‡∏¢‡∏±‡∏á‡∏Ñ‡∏•‡∏¥‡∏õ‡∏ö‡∏≠‡∏£‡πå‡∏î‡πÅ‡∏•‡πâ‡∏ß');
                })
                .catch(err => {
                    console.error('‚ùå ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß:', err);
                    showMessage('error', '‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏î‡πâ');
                });
        }

        // ============================================
        // 11. ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Event Listeners
        // ============================================
        function setupEventListeners() {
            console.log('üîå ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Event Listeners...');
            
            // ‡∏õ‡∏∏‡πà‡∏°‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤
            elements.saveConfigBtn.addEventListener('click', saveConfig);
            
            // ‡∏õ‡∏∏‡πà‡∏°‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
            elements.loadDataBtn.addEventListener('click', loadDataFromGoogleSheets);
            
            // ‡∏õ‡∏∏‡πà‡∏°‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤
            elements.searchBtn.addEventListener('click', performSearch);
            
            // ‡∏õ‡∏∏‡πà‡∏°‡∏•‡πâ‡∏≤‡∏á
            elements.clearBtn.addEventListener('click', clearSearch);
            
            // ‡∏õ‡∏∏‡πà‡∏°‡∏ó‡∏î‡∏™‡∏≠‡∏ö
            elements.testBtn.addEventListener('click', testSystem);
            
            // ‡∏õ‡∏∏‡πà‡∏°‡∏•‡πâ‡∏≤‡∏á‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥
            elements.clearHistoryBtn.addEventListener('click', clearSearchHistory);
            
            // ‡∏Å‡∏î Enter ‡πÉ‡∏ô‡∏ä‡πà‡∏≠‡∏á‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤
            elements.searchInput.addEventListener('keypress', function(event) {
                if (event.key === 'Enter') {
                    event.preventDefault();
                    performSearch();
                }
            });
            
            // ‡∏Å‡∏î Enter ‡πÉ‡∏ô‡∏ä‡πà‡∏≠‡∏á‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤
            [elements.sheetId, elements.sheetName].forEach(input => {
                input.addEventListener('keypress', function(event) {
                    if (event.key === 'Enter') {
                        event.preventDefault();
                        saveConfig();
                    }
                });
            });
            
            console.log('‚úÖ ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Event Listeners ‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô');
        }

        // ============================================
        // 12. ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö
        // ============================================
        function initializeSystem() {
            console.log('üöÄ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤...');
            
            // ‡πÇ‡∏´‡∏•‡∏î‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÑ‡∏ß‡πâ
            loadConfig();
            
            // ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Event Listeners
            setupEventListeners();
            
            // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤
            updateHistoryDisplay();
            
            // ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏£‡∏∞‡∏ö‡∏ö
            systemReady = true;
            updateSystemStatus();
            
            // Focus ‡∏ó‡∏µ‡πà‡∏ä‡πà‡∏≠‡∏á‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤
            elements.searchInput.focus();
            
            // ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ï‡πâ‡∏≠‡∏ô‡∏£‡∏±‡∏ö
            setTimeout(() => {
                if (sheetConfig.sheetId) {
                    showMessage('info', `‡∏£‡∏∞‡∏ö‡∏ö‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô! ‡∏ä‡∏∑‡πà‡∏≠‡∏ä‡∏µ‡∏ï‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏Ñ‡∏∑‡∏≠ "‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞" ‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏° "‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å Google Sheets" ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô`, 10000);
                } else {
                    showMessage('info', '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Google Sheet ID ‡∏Å‡πà‡∏≠‡∏ô‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô', 10000);
                }
                console.log('üéâ ‡∏£‡∏∞‡∏ö‡∏ö‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÅ‡∏•‡πâ‡∏ß!');
                console.log('üìù ‡∏ä‡∏∑‡πà‡∏≠‡∏ä‡∏µ‡∏ï‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô: "‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞"');
            }, 1500);
        }

        // ============================================
        // 13. ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏´‡∏ô‡πâ‡∏≤‡πÇ‡∏´‡∏•‡∏î‡πÄ‡∏™‡∏£‡πá‡∏à
        // ============================================
        document.addEventListener('DOMContentLoaded', function() {
            console.log('üìÑ ‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö‡πÇ‡∏´‡∏•‡∏î‡πÄ‡∏™‡∏£‡πá‡∏à‡πÅ‡∏•‡πâ‡∏ß');
            setTimeout(initializeSystem, 500);
        });

        // ============================================
        // 14. ‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏´‡∏•‡∏±‡∏Å‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÉ‡∏ä‡πâ‡∏à‡∏≤‡∏Å Console ‡πÑ‡∏î‡πâ
        // ============================================
        window.performSearch = performSearch;
        window.clearSearch = clearSearch;
        window.testSystem = testSystem;
        window.loadDataFromGoogleSheets = loadDataFromGoogleSheets;
        window.saveConfig = saveConfig;
        window.sheetData = sheetData;
        window.sheetConfig = sheetConfig;
    </script>
</body>
</html>
