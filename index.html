<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡πÄ‡∏•‡∏Ç‡πÅ‡∏õ‡∏•‡∏á IN-TECH ‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£‡∏ú‡πà‡∏≤‡∏Å‡∏≠</title>
    <style>
        /* Reset & Base */
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Segoe UI', 'Kanit', sans-serif;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        /* Container */
        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        
        /* Header */
        .header {
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }
        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }
        .header p {
            opacity: 0.9;
            font-size: 1.1rem;
        }
        
        /* Main Content */
        .main-content {
            padding: 30px;
        }
        
        /* Search Section */
        .search-section {
            margin-bottom: 30px;
        }
        .search-box {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }
        #searchInput {
            flex: 1;
            padding: 15px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
        }
        #searchInput:focus {
            outline: none;
            border-color: #2a5298;
        }
        .buttons {
            display: flex;
            gap: 10px;
        }
        button {
            padding: 15px 25px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s;
        }
        #searchBtn {
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            color: white;
        }
        #clearBtn {
            background: #f8f9fa;
            color: #333;
            border: 2px solid #ddd;
        }
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        /* Status Box */
        .status-box {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            border-left: 4px solid #2a5298;
        }
        .status-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
        }
        .status-label {
            font-weight: 600;
            color: #555;
        }
        .status-value {
            color: #333;
        }
        
        /* Results Section */
        .results-section {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            min-height: 200px;
        }
        .loading {
            text-align: center;
            padding: 40px;
            display: none;
        }
        .spinner {
            width: 40px;
            height: 40px;
            border: 4px solid #f3f3f3;
            border-top: 4px solid #2a5298;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 15px;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        .no-data {
            text-align: center;
            padding: 40px;
            color: #666;
        }
        
        /* Results Display */
        .result-card {
            background: white;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 15px;
            box-shadow: 0 3px 10px rgba(0,0,0,0.08);
            border-left: 4px solid #4CAF50;
        }
        .result-row {
            display: flex;
            padding: 10px 0;
            border-bottom: 1px solid #eee;
        }
        .result-row:last-child {
            border-bottom: none;
        }
        .result-label {
            font-weight: 600;
            color: #555;
            min-width: 150px;
        }
        .result-value {
            color: #333;
            flex: 1;
        }
        .highlight {
            background: #FFF9C4;
            padding: 2px 4px;
            border-radius: 3px;
            font-weight: bold;
        }
        
        /* Alerts */
        .alert {
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 15px;
            display: none;
        }
        .alert-error {
            background: #FFEBEE;
            color: #C62828;
            border: 1px solid #FFCDD2;
        }
        .alert-success {
            background: #E8F5E9;
            color: #2E7D32;
            border: 1px solid #C8E6C9;
        }
        
        /* Footer */
        .footer {
            text-align: center;
            padding: 20px;
            color: #666;
            border-top: 1px solid #eee;
            font-size: 0.9rem;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üîç ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡πÄ‡∏•‡∏Ç‡πÅ‡∏õ‡∏•‡∏á IN-TECH</h1>
            <p>‡∏£‡∏∞‡∏ö‡∏ö‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡πÄ‡∏•‡∏Ç‡πÅ‡∏õ‡∏•‡∏á‡∏à‡∏≤‡∏Å Google Sheet ‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£‡∏ú‡πà‡∏≤‡∏Å‡∏≠</p>
        </div>
        
        <div class="main-content">
            <!-- Search Section -->
            <div class="search-section">
                <div class="search-box">
                    <input type="text" id="searchInput" 
                           placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡πÄ‡∏•‡∏Ç‡πÅ‡∏õ‡∏•‡∏á‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤ ‡πÄ‡∏ä‡πà‡∏ô 10001145e3, IN-TECH-001"
                           autocomplete="off">
                </div>
                <div class="buttons">
                    <button id="searchBtn">
                        <span>üîç</span> ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤
                    </button>
                    <button id="clearBtn">
                        <span>üóëÔ∏è</span> ‡∏•‡πâ‡∏≤‡∏á
                    </button>
                    <button id="loadDataBtn">
                        <span>üì•</span> ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡∏°‡πà
                    </button>
                </div>
                
                <div class="alert" id="errorAlert"></div>
                <div class="alert" id="successAlert"></div>
                
                <div class="status-box">
                    <div class="status-item">
                        <span class="status-label">‡πÅ‡∏´‡∏•‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•:</span>
                        <span class="status-value" id="dataSource">Google Sheet ‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£‡∏ú‡πà‡∏≤‡∏Å‡∏≠</span>
                    </div>
                    <div class="status-item">
                        <span class="status-label">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏£‡∏∞‡∏ö‡∏ö:</span>
                        <span class="status-value" id="systemStatus">‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</span>
                    </div>
                    <div class="status-item">
                        <span class="status-label">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•:</span>
                        <span class="status-value" id="dataCount">0 ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</span>
                    </div>
                </div>
            </div>
            
            <!-- Results Section -->
            <div class="results-section" id="resultsSection">
                <div class="loading" id="loading">
                    <div class="spinner"></div>
                    <p>‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...</p>
                </div>
                
                <div class="no-data" id="noData">
                    <p>üîé ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡πÄ‡∏•‡∏Ç‡πÅ‡∏õ‡∏•‡∏á‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤</p>
                </div>
                
                <div id="resultsContainer"></div>
            </div>
        </div>
        
        <div class="footer">
            <p>¬© 2023 ‡∏£‡∏∞‡∏ö‡∏ö‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡πÄ‡∏•‡∏Ç‡πÅ‡∏õ‡∏•‡∏á IN-TECH | Google Sheet: ‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£‡∏ú‡πà‡∏≤‡∏Å‡∏≠</p>
            <p id="lastUpdated">‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î: -</p>
        </div>
    </div>

    <script>
        // ========== ‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£‡∏´‡∏•‡∏±‡∏Å ==========
        let sheetData = []; // ‡πÄ‡∏Å‡πá‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å Google Sheet
        let searchHistory = []; // ‡πÄ‡∏Å‡πá‡∏ö‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤
        
        // ========== DOM Elements ==========
        const elements = {
            searchInput: document.getElementById('searchInput'),
            searchBtn: document.getElementById('searchBtn'),
            clearBtn: document.getElementById('clearBtn'),
            loadDataBtn: document.getElementById('loadDataBtn'),
            resultsSection: document.getElementById('resultsSection'),
            loading: document.getElementById('loading'),
            noData: document.getElementById('noData'),
            resultsContainer: document.getElementById('resultsContainer'),
            errorAlert: document.getElementById('errorAlert'),
            successAlert: document.getElementById('successAlert'),
            systemStatus: document.getElementById('systemStatus'),
            dataCount: document.getElementById('dataCount'),
            lastUpdated: document.getElementById('lastUpdated'),
            dataSource: document.getElementById('dataSource')
        };
        
        // ========== ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÅ‡∏™‡∏î‡∏á/‡∏ã‡πà‡∏≠‡∏ô Loading ==========
        function showLoading(show, message = '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...') {
            if (show) {
                elements.loading.style.display = 'block';
                elements.noData.style.display = 'none';
                elements.resultsContainer.innerHTML = '';
                elements.loading.querySelector('p').textContent = message;
            } else {
                elements.loading.style.display = 'none';
            }
        }
        
        // ========== ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÅ‡∏™‡∏î‡∏á Alert ==========
        function showAlert(type, message) {
            const alertElement = type === 'error' ? elements.errorAlert : elements.successAlert;
            const otherAlert = type === 'error' ? elements.successAlert : elements.errorAlert;
            
            alertElement.textContent = message;
            alertElement.className = `alert alert-${type}`;
            alertElement.style.display = 'block';
            otherAlert.style.display = 'none';
            
            // ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥‡∏ã‡πà‡∏≠‡∏ô‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å 5 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ
            setTimeout(() => {
                alertElement.style.display = 'none';
            }, 5000);
        }
        
        // ========== ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å Google Sheet ==========
        async function fetchGoogleSheetData() {
            showAlert('success', '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å Google Sheet...');
            showLoading(true, '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...');
            
            try {
                // URL ‡∏Ç‡∏≠‡∏á Google Sheet (‡πÅ‡∏ö‡∏ö pubhtml)
                const sheetUrl = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vTHlqFXL5N8DKNhyg8au_M9eypFk65rXRgXdCna7pO9gadqpHLmtcz8FHKeCaBlxuqGcIY60PxUhyu-/pubhtml?gid=980262450&single=true';
                
                // ‡πÉ‡∏ä‡πâ proxy ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÅ‡∏Å‡πâ‡∏õ‡∏±‡∏ç‡∏´‡∏≤ CORS
                const proxyUrl = 'https://api.allorigins.win/get?url=';
                const response = await fetch(proxyUrl + encodeURIComponent(sheetUrl));
                
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Å‡∏±‡∏ö Google Sheet`);
                }
                
                const result = await response.json();
                
                if (!result.contents) {
                    throw new Error('‡πÑ‡∏°‡πà‡∏û‡∏ö‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡πÉ‡∏ô Google Sheet');
                }
                
                // ‡πÅ‡∏õ‡∏•‡∏á HTML ‡πÄ‡∏õ‡πá‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
                await parseSheetHTML(result.contents);
                
                // ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞
                updateSystemStatus();
                showAlert('success', `‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à! ‡∏û‡∏ö ${sheetData.length} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£`);
                
            } catch (error) {
                console.error('Error fetching sheet:', error);
                showAlert('error', `‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•: ${error.message}`);
                
                // ‡πÉ‡∏ä‡πâ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ñ‡πâ‡∏≤‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ
                useSampleData();
                showAlert('success', `‡πÉ‡∏ä‡πâ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á ${sheetData.length} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£`);
            } finally {
                showLoading(false);
            }
        }
        
        // ========== ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÅ‡∏õ‡∏•‡∏á HTML ‡πÄ‡∏õ‡πá‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• ==========
        async function parseSheetHTML(htmlContent) {
            try {
                // ‡∏™‡∏£‡πâ‡∏≤‡∏á DOM ‡∏à‡∏≥‡∏•‡∏≠‡∏á
                const parser = new DOMParser();
                const doc = parser.parseFromString(htmlContent, 'text/html');
                
                // ‡∏´‡∏≤‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
                const tables = doc.querySelectorAll('table');
                
                if (tables.length === 0) {
                    throw new Error('‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÉ‡∏ô Google Sheet');
                }
                
                // ‡πÉ‡∏ä‡πâ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡πÅ‡∏£‡∏Å (‡∏´‡∏£‡∏∑‡∏≠‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏°‡∏≤‡∏Å‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î)
                let targetTable = tables[0];
                let maxRows = 0;
                
                tables.forEach(table => {
                    const rows = table.querySelectorAll('tr').length;
                    if (rows > maxRows) {
                        maxRows = rows;
                        targetTable = table;
                    }
                });
                
                // ‡∏î‡∏∂‡∏á‡πÅ‡∏ñ‡∏ß‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
                const rows = targetTable.querySelectorAll('tr');
                
                if (rows.length < 2) {
                    throw new Error('‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏°‡πà‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡∏û‡∏≠');
                }
                
                // ‡∏î‡∏∂‡∏á‡∏´‡∏±‡∏ß‡∏ï‡∏≤‡∏£‡∏≤‡∏á (‡πÅ‡∏ñ‡∏ß‡πÅ‡∏£‡∏Å)
                const headerRow = rows[0];
                const headerCells = headerRow.querySelectorAll('td, th');
                const headers = Array.from(headerCells).map((cell, index) => {
                    const text = cell.textContent.trim();
                    return text || `‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå_${index + 1}`;
                });
                
                console.log('‡∏û‡∏ö‡∏´‡∏±‡∏ß‡∏ï‡∏≤‡∏£‡∏≤‡∏á:', headers);
                
                // ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏à‡∏≤‡∏Å‡πÅ‡∏ñ‡∏ß‡∏ó‡∏µ‡πà 2)
                sheetData = [];
                
                for (let i = 1; i < rows.length; i++) {
                    const cells = rows[i].querySelectorAll('td, th');
                    const rowData = {};
                    
                    // ‡πÄ‡∏ï‡∏¥‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏≤‡∏°‡∏´‡∏±‡∏ß‡∏ï‡∏≤‡∏£‡∏≤‡∏á
                    headers.forEach((header, index) => {
                        if (index < cells.length) {
                            rowData[header] = cells[index].textContent.trim();
                        } else {
                            rowData[header] = '';
                        }
                    });
                    
                    // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏£‡∏¥‡∏á‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
                    const hasData = Object.values(rowData).some(value => value !== '');
                    if (hasData) {
                        sheetData.push(rowData);
                    }
                }
                
                console.log('‡πÅ‡∏õ‡∏•‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à:', sheetData.length, '‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£');
                
                // ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏•‡∏á localStorage
                saveToLocalStorage();
                
            } catch (error) {
                console.error('Error parsing HTML:', error);
                throw error;
            }
        }
        
        // ========== ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÉ‡∏ä‡πâ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á ==========
        function useSampleData() {
            sheetData = [
                {
                    '‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡πÅ‡∏õ‡∏•‡∏á': '10001145e3',
                    '‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£': '‡∏ú‡πà‡∏≤‡∏Å‡∏≠',
                    '‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á': '‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó ‡∏≠‡∏¥‡∏ô‡πÄ‡∏ó‡∏Ñ ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
                    '‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà': '123 ‡∏´‡∏°‡∏π‡πà 4 ‡∏ï.‡∏™‡∏∏‡πÄ‡∏ó‡∏û ‡∏≠.‡πÄ‡∏°‡∏∑‡∏≠‡∏á ‡∏à.‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡πÉ‡∏´‡∏°‡πà',
                    '‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà': '2.5 ‡πÑ‡∏£‡πà',
                    '‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏ó‡∏µ‡πà‡∏î‡∏¥‡∏ô': '‡∏ó‡∏µ‡πà‡∏î‡∏¥‡∏ô‡∏≠‡∏∏‡∏ï‡∏™‡∏≤‡∏´‡∏Å‡∏£‡∏£‡∏°',
                    '‡πÇ‡∏â‡∏ô‡∏î‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà': '‡∏ô‡∏™.123456',
                    '‡∏≠‡∏≥‡πÄ‡∏†‡∏≠': '‡πÄ‡∏°‡∏∑‡∏≠‡∏á',
                    '‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î': '‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡πÉ‡∏´‡∏°‡πà',
                    '‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞': '‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£',
                    '‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏': '‡πÅ‡∏õ‡∏•‡∏á IN-TECH ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç 001'
                },
                {
                    '‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡πÅ‡∏õ‡∏•‡∏á': 'IN-TECH-002',
                    '‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£': '‡∏ú‡πà‡∏≤‡∏Å‡∏≠',
                    '‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á': '‡∏ô‡∏≤‡∏¢‡∏™‡∏°‡∏ä‡∏≤‡∏¢ ‡πÉ‡∏à‡∏î‡∏µ',
                    '‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà': '456 ‡∏´‡∏°‡∏π‡πà 2 ‡∏ï.‡πÉ‡∏ô‡πÄ‡∏°‡∏∑‡∏≠‡∏á ‡∏≠.‡πÄ‡∏°‡∏∑‡∏≠‡∏á ‡∏à.‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡πÉ‡∏´‡∏°‡πà',
                    '‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà': '1 ‡πÑ‡∏£‡πà',
                    '‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏ó‡∏µ‡πà‡∏î‡∏¥‡∏ô': '‡∏ó‡∏µ‡πà‡∏î‡∏¥‡∏ô‡πÄ‡∏Å‡∏©‡∏ï‡∏£‡∏Å‡∏£‡∏£‡∏°',
                    '‡πÇ‡∏â‡∏ô‡∏î‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà': '‡∏ô‡∏™.789012',
                    '‡∏≠‡∏≥‡πÄ‡∏†‡∏≠': '‡πÄ‡∏°‡∏∑‡∏≠‡∏á',
                    '‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î': '‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡πÉ‡∏´‡∏°‡πà',
                    '‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞': '‡∏£‡∏≠‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£',
                    '‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏': '‡πÅ‡∏õ‡∏•‡∏á‡∏õ‡∏•‡∏π‡∏Å‡∏ú‡∏±‡∏Å‡∏≠‡∏¥‡∏ô‡∏ó‡∏£‡∏µ‡∏¢‡πå'
                },
                {
                    '‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡πÅ‡∏õ‡∏•‡∏á': '10002233f4',
                    '‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£': '‡∏ú‡πà‡∏≤‡∏Å‡∏≠',
                    '‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á': '‡∏ô‡∏≤‡∏á‡∏™‡∏≤‡∏ß‡∏™‡∏∏‡∏ô‡∏¥‡∏î‡∏≤ ‡∏£‡∏±‡∏Å‡∏ò‡∏£‡∏£‡∏°',
                    '‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà': '789 ‡∏´‡∏°‡∏π‡πà 5 ‡∏ï.‡∏ä‡πâ‡∏≤‡∏á‡πÄ‡∏ú‡∏∑‡∏≠‡∏Å ‡∏≠.‡πÄ‡∏°‡∏∑‡∏≠‡∏á ‡∏à.‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡πÉ‡∏´‡∏°‡πà',
                    '‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà': '3 ‡πÑ‡∏£‡πà',
                    '‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏ó‡∏µ‡πà‡∏î‡∏¥‡∏ô': '‡∏ó‡∏µ‡πà‡∏î‡∏¥‡∏ô‡∏û‡∏≤‡∏ì‡∏¥‡∏ä‡∏¢‡πå',
                    '‡πÇ‡∏â‡∏ô‡∏î‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà': '‡∏ô‡∏™.345678',
                    '‡∏≠‡∏≥‡πÄ‡∏†‡∏≠': '‡πÄ‡∏°‡∏∑‡∏≠‡∏á',
                    '‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î': '‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡πÉ‡∏´‡∏°‡πà',
                    '‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞': '‡πÄ‡∏™‡∏£‡πá‡∏à‡∏™‡∏¥‡πâ‡∏ô',
                    '‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏': '‡πÅ‡∏õ‡∏•‡∏á‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏Å‡∏£‡∏∞‡∏à‡∏≤‡∏¢‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤'
                },
                {
                    '‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡πÅ‡∏õ‡∏•‡∏á': 'TECH-001',
                    '‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£': '‡∏ú‡πà‡∏≤‡∏Å‡∏≠',
                    '‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á': '‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó ‡πÄ‡∏ó‡∏Ñ‡πÇ‡∏ô‡πÇ‡∏•‡∏¢‡∏µ ‡πÑ‡∏ó‡∏¢ ‡∏à‡∏≥‡∏Å‡∏±‡∏î',
                    '‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà': '321 ‡∏´‡∏°‡∏π‡πà 1 ‡∏ï.‡πÅ‡∏°‡πà‡πÄ‡∏´‡∏µ‡∏¢‡∏∞ ‡∏≠.‡πÄ‡∏°‡∏∑‡∏≠‡∏á ‡∏à.‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡πÉ‡∏´‡∏°‡πà',
                    '‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà': '5 ‡πÑ‡∏£‡πà',
                    '‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏ó‡∏µ‡πà‡∏î‡∏¥‡∏ô': '‡∏ó‡∏µ‡πà‡∏î‡∏¥‡∏ô‡∏≠‡∏∏‡∏ï‡∏™‡∏≤‡∏´‡∏Å‡∏£‡∏£‡∏°',
                    '‡πÇ‡∏â‡∏ô‡∏î‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà': '‡∏ô‡∏™.901234',
                    '‡∏≠‡∏≥‡πÄ‡∏†‡∏≠': '‡πÄ‡∏°‡∏∑‡∏≠‡∏á',
                    '‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î': '‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡πÉ‡∏´‡∏°‡πà',
                    '‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞': '‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£',
                    '‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏': '‡πÅ‡∏õ‡∏•‡∏á‡πÇ‡∏£‡∏á‡∏á‡∏≤‡∏ô‡∏ú‡∏•‡∏¥‡∏ï'
                },
                {
                    '‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡πÅ‡∏õ‡∏•‡∏á': '10003344g5',
                    '‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£': '‡∏ú‡πà‡∏≤‡∏Å‡∏≠',
                    '‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á': '‡∏ô‡∏≤‡∏¢‡∏ò‡∏ô‡∏ß‡∏±‡∏í‡∏ô‡πå ‡∏û‡∏±‡∏í‡∏ô‡∏≤',
                    '‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà': '654 ‡∏´‡∏°‡∏π‡πà 3 ‡∏ï.‡∏´‡∏ô‡∏≠‡∏á‡∏´‡∏≠‡∏¢ ‡∏≠.‡πÄ‡∏°‡∏∑‡∏≠‡∏á ‡∏à.‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡πÉ‡∏´‡∏°‡πà',
                    '‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà': '0.75 ‡πÑ‡∏£‡πà',
                    '‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏ó‡∏µ‡πà‡∏î‡∏¥‡∏ô': '‡∏ó‡∏µ‡πà‡∏î‡∏¥‡∏ô‡∏≠‡∏¢‡∏π‡πà‡∏≠‡∏≤‡∏®‡∏±‡∏¢',
                    '‡πÇ‡∏â‡∏ô‡∏î‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà': '‡∏ô‡∏™.567890',
                    '‡∏≠‡∏≥‡πÄ‡∏†‡∏≠': '‡πÄ‡∏°‡∏∑‡∏≠‡∏á',
                    '‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î': '‡πÄ‡∏ä‡∏µ‡∏¢‡∏á‡πÉ‡∏´‡∏°‡πà',
                    '‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞': '‡∏£‡∏≠‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£',
                    '‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏': '‡πÅ‡∏õ‡∏•‡∏á‡∏ó‡∏µ‡πà‡∏î‡∏¥‡∏ô‡∏£‡∏≠‡∏Å‡∏≤‡∏£‡∏û‡∏±‡∏í‡∏ô‡∏≤'
                }
            ];
            
            console.log('‡πÉ‡∏ä‡πâ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á:', sheetData.length, '‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£');
            saveToLocalStorage();
        }
        
        // ========== ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• ==========
        function searchData() {
            const searchTerm = elements.searchInput.value.trim();
            
            if (!searchTerm) {
                showAlert('error', '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡πÄ‡∏•‡∏Ç‡πÅ‡∏õ‡∏•‡∏á‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤');
                return;
            }
            
            // ‡∏ñ‡πâ‡∏≤‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
            if (sheetData.length === 0) {
                showAlert('error', '‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏î "‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡∏°‡πà"');
                return;
            }
            
            showLoading(true);
            
            // ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏´‡∏•‡∏±‡∏á‡∏à‡∏≤‡∏Å delay ‡πÄ‡∏•‡πá‡∏Å‡∏ô‡πâ‡∏≠‡∏¢
            setTimeout(() => {
                performSearch(searchTerm);
            }, 300);
        }
        
        // ========== ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏à‡∏£‡∏¥‡∏á ==========
        function performSearch(searchTerm) {
            try {
                // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏´‡∏•‡∏≤‡∏¢‡πÅ‡∏ö‡∏ö
                const searchPatterns = [
                    searchTerm,
                    searchTerm.toUpperCase(),
                    searchTerm.toLowerCase(),
                    searchTerm.replace(/\s/g, ''),
                    searchTerm.replace(/[^a-zA-Z0-9]/g, '')
                ];
                
                console.log('‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤:', searchPatterns);
                
                // ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡πÉ‡∏ô‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå
                const results = sheetData.filter(row => {
                    // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå‡πÉ‡∏ô‡πÅ‡∏ñ‡∏ß
                    for (const key in row) {
                        const cellValue = String(row[key] || '');
                        
                        // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ó‡∏∏‡∏Å‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤
                        for (const pattern of searchPatterns) {
                            if (pattern && cellValue.includes(pattern)) {
                                console.log(`‡∏û‡∏ö "${pattern}" ‡πÉ‡∏ô‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå "${key}": ${cellValue}`);
                                return true;
                            }
                        }
                        
                        // ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡πÅ‡∏ö‡∏ö‡πÑ‡∏°‡πà‡∏™‡∏ô‡πÉ‡∏à case
                        if (cellValue.toLowerCase().includes(searchTerm.toLowerCase())) {
                            console.log(`‡∏û‡∏ö (‡πÑ‡∏°‡πà‡∏™‡∏ô‡πÉ‡∏à case) ‡πÉ‡∏ô "${key}": ${cellValue}`);
                            return true;
                        }
                    }
                    return false;
                });
                
                // ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå ‡πÉ‡∏´‡πâ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡πÅ‡∏ö‡∏ö‡∏™‡πà‡∏ß‡∏ô‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏≥
                if (results.length === 0 && searchTerm.length > 3) {
                    console.log('‡∏•‡∏≠‡∏á‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡πÅ‡∏ö‡∏ö‡∏™‡πà‡∏ß‡∏ô‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏≥...');
                    
                    const partialResults = sheetData.filter(row => {
                        for (const key in row) {
                            const cellValue = String(row[key] || '');
                            
                            // ‡∏´‡∏≤‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç‡πÉ‡∏ô‡πÄ‡∏ã‡∏•‡∏•‡πå
                            const numbers = cellValue.match(/\d+/g);
                            if (numbers) {
                                for (const num of numbers) {
                                    if (num.includes(searchTerm.replace(/\D/g, ''))) {
                                        console.log(`‡∏û‡∏ö‡∏™‡πà‡∏ß‡∏ô‡∏Ç‡∏≠‡∏á‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç‡πÉ‡∏ô "${key}": ${cellValue}`);
                                        return true;
                                    }
                                }
                            }
                            
                            // ‡∏´‡∏≤‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£‡πÉ‡∏ô‡πÄ‡∏ã‡∏•‡∏•‡πå
                            const letters = cellValue.match(/[a-zA-Z]+/g);
                            if (letters) {
                                for (const letter of letters) {
                                    if (letter.toLowerCase().includes(searchTerm.replace(/[^a-zA-Z]/g, '').toLowerCase())) {
                                        console.log(`‡∏û‡∏ö‡∏™‡πà‡∏ß‡∏ô‡∏Ç‡∏≠‡∏á‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£‡πÉ‡∏ô "${key}": ${cellValue}`);
                                        return true;
                                    }
                                }
                            }
                        }
                        return false;
                    });
                    
                    if (partialResults.length > 0) {
                        displayResults(partialResults, searchTerm);
                        showAlert('success', `‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ö "${searchTerm}"`);
                        showLoading(false);
                        return;
                    }
                }
                
                // ‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå
                displayResults(results, searchTerm);
                
                // ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤
                saveSearchHistory(searchTerm, results.length);
                
            } catch (error) {
                console.error('Error in search:', error);
                showAlert('error', `‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤: ${error.message}`);
            } finally {
                showLoading(false);
            }
        }
        
        // ========== ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå ==========
        function displayResults(results, searchTerm) {
            elements.resultsContainer.innerHTML = '';
            
            if (results.length === 0) {
                elements.noData.innerHTML = `
                    <p>‚ùå ‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö <strong>"${searchTerm}"</strong></p>
                    <p style="margin-top: 10px; font-size: 0.9em; color: #666;">
                        ‡∏•‡∏≠‡∏á‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡πÅ‡∏ö‡∏ö‡∏≠‡∏∑‡πà‡∏ô ‡πÄ‡∏ä‡πà‡∏ô:<br>
                        - "${searchTerm.substring(0, 8)}" (‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏™‡πà‡∏ß‡∏ô‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç)<br>
                        - "${searchTerm.replace(/\d/g, '')}" (‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£)<br>
                        - ‡∏´‡∏£‡∏∑‡∏≠‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏™‡∏∞‡∏Å‡∏î‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á
                    </p>
                    <p style="margin-top: 10px; color: #888;">
                        ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö: ${sheetData.length} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£
                    </p>
                `;
                elements.noData.style.display = 'block';
                return;
            }
            
            elements.noData.style.display = 'none';
            
            // ‡πÅ‡∏™‡∏î‡∏á‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå
            results.forEach((result, index) => {
                const card = document.createElement('div');
                card.className = 'result-card';
                
                let html = `
                    <div style="margin-bottom: 15px;">
                        <h3 style="color: #1e3c72;">
                            üó∫Ô∏è ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏ó‡∏µ‡πà ${index + 1} ‡∏Ç‡∏≠‡∏á "${searchTerm}"
                        </h3>
                        <p style="color: #666; font-size: 0.9em;">
                            üìÖ ‡∏Ñ‡πâ‡∏ô‡∏û‡∏ö‡πÄ‡∏°‡∏∑‡πà‡∏≠: ${new Date().toLocaleString('th-TH')}
                        </p>
                    </div>
                `;
                
                // ‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
                Object.keys(result).forEach(key => {
                    let value = result[key] || '(‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•)';
                    
                    // ‡πÄ‡∏ô‡πâ‡∏ô‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏Ñ‡πâ‡∏ô‡∏û‡∏ö
                    if (typeof value === 'string') {
                        const escapedSearchTerm = searchTerm.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
                        const regex = new RegExp(`(${escapedSearchTerm})`, 'gi');
                        value = value.replace(regex, '<span class="highlight">$1</span>');
                    }
                    
                    html += `
                        <div class="result-row">
                            <div class="result-label">${key}:</div>
                            <div class="result-value">${value}</div>
                        </div>
                    `;
                });
                
                card.innerHTML = html;
                elements.resultsContainer.appendChild(card);
            });
            
            // ‡πÅ‡∏™‡∏î‡∏á‡∏™‡∏£‡∏∏‡∏õ‡∏ú‡∏•
            const summary = document.createElement('div');
            summary.className = 'result-card';
            summary.style.backgroundColor = '#E8F0FE';
            summary.style.borderLeftColor = '#1e3c72';
            
            summary.innerHTML = `
                <div style="display: flex; align-items: center; gap: 10px;">
                    <span style="font-size: 1.5em;">üìä</span>
                    <h3 style="color: #1e3c72; margin: 0;">‡∏™‡∏£‡∏∏‡∏õ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤</h3>
                </div>
                <div style="margin-top: 10px;">
                    <p>‚úÖ <strong>‡∏û‡∏ö‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î ${results.length} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</strong> ‡∏ó‡∏µ‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö "${searchTerm}"</p>
                    <p>üìÅ ‡∏à‡∏≤‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î ${sheetData.length} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö</p>
                </div>
            `;
            
            elements.resultsContainer.appendChild(summary);
        }
        
        // ========== ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô Utility ==========
        function updateSystemStatus() {
            elements.dataCount.textContent = `${sheetData.length} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£`;
            elements.systemStatus.textContent = '‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô';
            elements.dataSource.textContent = 'Google Sheet ‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£‡∏ú‡πà‡∏≤‡∏Å‡∏≠';
            elements.lastUpdated.textContent = `‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î: ${new Date().toLocaleString('th-TH')}`;
        }
        
        function saveToLocalStorage() {
            try {
                localStorage.setItem('sheetData', JSON.stringify(sheetData));
                localStorage.setItem('lastUpdated', new Date().toISOString());
                updateSystemStatus();
            } catch (error) {
                console.error('Error saving to localStorage:', error);
            }
        }
        
        function loadFromLocalStorage() {
            try {
                const savedData = localStorage.getItem('sheetData');
                const savedTime = localStorage.getItem('lastUpdated');
                
                if (savedData) {
                    sheetData = JSON.parse(savedData);
                    console.log('‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å localStorage:', sheetData.length, '‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£');
                    
                    if (savedTime) {
                        const time = new Date(savedTime);
                        elements.lastUpdated.textContent = `‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î: ${time.toLocaleString('th-TH')}`;
                    }
                    
                    updateSystemStatus();
                    return true;
                }
            } catch (error) {
                console.error('Error loading from localStorage:', error);
            }
            return false;
        }
        
        function saveSearchHistory(term, results) {
            searchHistory.unshift({
                term: term,
                results: results,
                time: new Date().toISOString()
            });
            
            // ‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏â‡∏û‡∏≤‡∏∞ 20 ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î
            if (searchHistory.length > 20) {
                searchHistory.pop();
            }
            
            localStorage.setItem('searchHistory', JSON.stringify(searchHistory));
        }
        
        function clearSearch() {
            elements.searchInput.value = '';
            elements.resultsContainer.innerHTML = '';
            elements.noData.innerHTML = '<p>üîé ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡πÄ‡∏•‡∏Ç‡πÅ‡∏õ‡∏•‡∏á‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤</p>';
            elements.noData.style.display = 'block';
            elements.errorAlert.style.display = 'none';
            elements.successAlert.style.display = 'none';
        }
        
        // ========== Event Listeners ==========
        function setupEventListeners() {
            elements.searchBtn.addEventListener('click', searchData);
            
            elements.clearBtn.addEventListener('click', clearSearch);
            
            elements.loadDataBtn.addEventListener('click', fetchGoogleSheetData);
            
            elements.searchInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    searchData();
                }
            });
            
            // Auto-focus ‡∏ó‡∏µ‡πà‡∏ä‡πà‡∏≠‡∏á‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤
            elements.searchInput.focus();
        }
        
        // ========== Initialize ==========
        function initialize() {
            console.log('üöÄ ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡πÄ‡∏•‡∏Ç‡πÅ‡∏õ‡∏•‡∏á IN-TECH');
            
            // 1. ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å localStorage ‡∏Å‡πà‡∏≠‡∏ô
            const hasLocalData = loadFromLocalStorage();
            
            // 2. ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô localStorage ‡πÉ‡∏´‡πâ‡πÇ‡∏´‡∏•‡∏î‡∏à‡∏≤‡∏Å Google Sheet
            if (!hasLocalData || sheetData.length === 0) {
                console.log('‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô localStorage, ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÉ‡∏ä‡πâ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á...');
                useSampleData();
            }
            
            // 3. ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ Event Listeners
            setupEventListeners();
            
            // 4. ‡πÅ‡∏™‡∏î‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏£‡∏∞‡∏ö‡∏ö
            updateSystemStatus();
            
            // 5. ‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô
            setTimeout(() => {
                showAlert('success', `‡∏£‡∏∞‡∏ö‡∏ö‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô! ‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• ${sheetData.length} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£`);
            }, 1000);
            
            console.log('‚úÖ ‡∏£‡∏∞‡∏ö‡∏ö‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÅ‡∏•‡πâ‡∏ß');
            console.log('üìù ‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏û‡∏¥‡πÄ‡∏®‡∏©:');
            console.log('   searchData("10001145e3") - ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡πÄ‡∏•‡∏Ç‡πÅ‡∏õ‡∏•‡∏á');
            console.log('   console.log(sheetData) - ‡∏î‡∏π‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î');
        }
        
        // ========== Start Application ==========
        document.addEventListener('DOMContentLoaded', initialize);
    </script>
</body>
</html>
